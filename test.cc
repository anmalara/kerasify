#include "keras_model.h"

int main() {
  KerasModel model;
  model.LoadModel("/beegfs/desy/user/amalara/output_varariables/Sequential/model_AK8_pt_300_500/model_crosscheck/mymodel.model");

  Tensor in(13);
  // in.data_ = {{  1.52882206e-01,  -7.82382991e-01,   4.58294465e-01, 1.62019307e-01,   6.77150193e-02,   9.38621026e-01, 1.40192715e-01,   1.73891120e-01,   1.86060589e+00, 6.80000000e+01,   8.08964333e-01,   7.69246801e-01, 6.84956843e-01 }};

  in.data_ = {{  1.52882206e-01,  -7.82382991e-01,   4.58294465e-01, 1.62019307e-01,   6.77150193e-02,   9.38621026e-01, 1.40192715e-01,   1.73891120e-01,   1.86060589e+00, 6.80000000e+01,   8.08964333e-01,   7.69246801e-01, 6.84956843e-01 }};

  // Run prediction.
  Tensor out;
  model.Apply(&in, &out);
  out.Print();

  return 0;
}










data_train.data_ = {{  4.46115288e-01,  -6.02262921e-02,   5.84577114e-02, 1.12644406e-01,   3.80830124e-02,   9.38310247e-01, 7.89906373e-02,   8.56328135e-02,   1.08000687e+00, 4.40000000e+01,   7.96757582e-01,   7.80584386e-01, 8.12577065e-01 }};


       [  9.77443609e-02,  -6.45728378e-01,   4.25412002e-01,
          5.03212534e-01,   5.17757809e-02,   9.90454626e-01,
          6.57308077e-01,   5.34018396e-01,   3.24002060e+00,
          8.60000000e+01,   2.77360290e-01,   2.30378058e-01,
          2.71578298e-01],
       [  5.10025063e-01,   4.21661029e-01,   4.53980100e-02,
          4.75613230e-01,   6.80359435e-02,   9.22948855e-01,
          4.95690912e-01,   3.76836541e-01,   2.01209200e+00,
          5.70000000e+01,   2.16479115e-01,   2.06035597e-01,
          2.59556104e-01],
       [  2.60651629e-01,  -3.85230521e-01,   6.24689055e-01,
          2.83430923e-01,   3.81899872e-02,   9.27210975e-01,
          3.05284449e-01,   1.30353138e-01,   1.48010842e+00,
          4.70000000e+01,   2.66984551e-01,   2.44383310e-01,
          6.83723798e-01],
       [  3.58395990e-01,   1.41667743e+00,   6.38215174e-01,
          4.63965817e-01,   2.60376551e-01,   9.95649085e-01,
          4.98470569e-01,   4.28303166e-01,   3.84240067e+00,
          9.20000000e+01,   4.66259775e-01,   4.37455713e-01,
          5.57336621e-01],
       [  8.10776942e-01,   3.91318311e-01,   2.73631841e-01,
          5.86263649e-01,   9.56354300e-02,   9.88811934e-01,
          5.37385758e-01,   1.66101577e-01,   1.87486340e+00,
          5.90000000e+01,   1.77722678e-01,   1.67187695e-01,
          7.05918619e-01],
       [  3.58395990e-01,  -7.69346860e-01,   6.23289801e-01,
          1.89238804e-01,   9.00727428e-02,   9.14036139e-01,
          2.45521837e-01,   9.11967729e-02,   1.01852133e+00,
          6.00000000e+01,   2.17699790e-01,   2.06035597e-01,
          6.65228113e-01],
       [  5.62656642e-01,   1.20090699e+00,   1.74751244e-01,
          5.58917550e-01,   2.24005135e-01,   9.69055230e-01,
          6.17598700e-01,   4.92845096e-01,   2.51466945e+00,
          6.90000000e+01,   2.18157543e-01,   1.38843733e-01,
          1.31627620e-01],
       [  1.77944862e-01,   9.24001590e-01,   4.90715368e-01,
          5.81421111e-02,   9.22122379e-02,   9.19452584e-01,
          4.00258111e-02,   4.73458175e-02,   5.44904454e-01,
          4.40000000e+01,   7.18634370e-01,   6.58538619e-01,
          6.06658446e-01],
       [  1.77944862e-01,   1.85181449e+00,   5.37021922e-01,
          2.95584744e-01,   4.16345742e-01,   9.83750666e-01,
          3.84901750e-01,   1.32856919e-01,   1.51753440e+00,
          3.80000000e+01,   2.07171467e-01,   1.87361927e-01,
          6.79408138e-01]])




data_test.data_ = {{  1.52882206e-01,  -7.82382991e-01,   4.58294465e-01, 1.62019307e-01,   6.77150193e-02,   9.38621026e-01, 1.40192715e-01,   1.73891120e-01,   1.86060589e+00, 6.80000000e+01,   8.08964333e-01,   7.69246801e-01, 6.84956843e-01 }};
      [  1.04010025e-01,   2.02443085e+00,   9.82898010e-01,
         8.10571293e-02,   4.95079161e-01,   9.43371515e-01,
         5.72497534e-02,   4.34162711e-02,   5.09260663e-01,
         1.70000000e+01,   4.76940683e-01,   3.65095244e-01,
         4.91985203e-01],
      [  1.00250627e-01,  -3.15779410e-01,   4.62259017e-01,
         1.12897610e-01,   1.65810869e-02,   9.54581779e-01,
         6.39507107e-02,   7.81214682e-02,   8.46540035e-01,
         4.90000000e+01,   7.50982262e-01,   5.49831187e-01,
         4.66091245e-01],
      [  2.45614035e-01,   1.29260943e+00,   1.86256219e-01,
         3.80155088e-01,   1.94908002e-01,   9.64393536e-01,
         3.81129360e-01,   2.49839167e-01,   2.49684756e+00,
         8.10000000e+01,   3.84779706e-01,   3.76766287e-01,
         6.57829840e-01],
      [  9.64912281e-02,  -1.05569222e+00,   3.42039801e-02,
         8.15002374e-02,   1.08258451e-01,   9.16194948e-01,
         5.44700970e-02,   7.10274199e-02,   7.25796693e-01,
         3.50000000e+01,   7.39385848e-01,   6.33195782e-01,
         5.15413070e-01],
      [  5.45112782e-01,   3.45242331e-01,   9.98134328e-02,
         4.47507517e-01,   6.45057766e-02,   9.31517492e-01,
         3.80732266e-01,   3.05896058e-01,   2.22773693e+00,
         6.60000000e+01,   3.36868205e-01,   2.32878996e-01,
         2.78668311e-01],
      [  1.60401003e-01,   6.30463884e-01,   5.59701493e-02,
         1.50625099e-01,   4.80316645e-02,   9.17471364e-01,
         1.01674619e-01,   1.06080364e-01,   1.31258260e+00,
         4.10000000e+01,   7.67461377e-01,   6.90550623e-01,
         7.38594328e-01],
      [  1.12781955e-02,  -4.68616806e-01,   7.14552239e-01,
         3.05206520e-01,   2.15019255e-02,   9.23614811e-01,
         4.08330283e-01,   3.08678038e-01,   2.40773808e+00,
         7.30000000e+01,   3.40835400e-01,   3.22079113e-01,
         4.58076449e-01],
      [  1.39097744e-01,  -1.08718451e-01,   6.74751244e-01,
         5.76135464e-01,   2.59948652e-02,   9.22493784e-01,
         7.67303051e-01,   4.47777024e-01,   3.93507452e+00,
         7.40000000e+01,   2.91703223e-01,   2.02534284e-01,
         3.82860666e-01],
      [  1.12781955e-02,  -6.78093944e-01,   3.12500000e-01,
         3.19132774e-01,   4.10783055e-02,   9.19341591e-01,
         3.29705716e-01,   1.12687566e-01,   1.21099780e+00,
         5.20000000e+01,   1.87793248e-01,   1.82860239e-01,
         6.64611591e-01



         array([[ 0.14476113,  0.74322879,  0.11201009],
                [ 0.05147558,  0.87995833,  0.06856609],
                [ 0.17300698,  0.420205  ,  0.40678802],
                [ 0.0369037 ,  0.16144098,  0.80165529],
                [ 0.0449503 ,  0.78200394,  0.17304575],
                [ 0.17017224,  0.04697737,  0.78285038],
                [ 0.06490728,  0.67274153,  0.26235119],
                [ 0.5476616 ,  0.06784479,  0.38449362],
                [ 0.03523582,  0.01704395,  0.94772023],
                [ 0.11124282,  0.08566742,  0.80308974]], dtype=float32)
